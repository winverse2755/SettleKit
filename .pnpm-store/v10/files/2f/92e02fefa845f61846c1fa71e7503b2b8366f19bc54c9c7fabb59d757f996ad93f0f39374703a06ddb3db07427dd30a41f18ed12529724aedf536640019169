import type { Signature, TransactionReceipt, TransactionRequest, TransactionResponse } from "ethers";
import { type Observable, type Observer, ReplaySubject } from "rxjs";
import type { SignatureMessage } from "./signatures/types";
export declare enum NotificationStatus {
    signing = "signing",
    success = "success",
    error = "error",
    pending = "pending"
}
export declare enum NotificationTopic {
    tx = "tx",
    signature = "signature"
}
export interface NotificationContext {
    [NotificationTopic.tx]: {
        [NotificationStatus.signing]: {
            tx: TransactionRequest;
        };
        [NotificationStatus.pending]: {
            args: Record<PropertyKey, any>;
            tx: TransactionRequest;
            response?: TransactionResponse;
        };
        [NotificationStatus.success]: {
            args: Record<PropertyKey, any>;
            tx: TransactionRequest;
            response?: TransactionResponse;
            receipt: TransactionReceipt | null;
        };
        [NotificationStatus.error]: {
            args: Record<PropertyKey, any>;
            tx: TransactionRequest;
            response?: TransactionResponse;
            error: Error;
        };
    };
    [NotificationTopic.signature]: {
        [NotificationStatus.signing]: never;
        [NotificationStatus.pending]: {
            message: SignatureMessage;
            args: Record<PropertyKey, any>;
        };
        [NotificationStatus.success]: {
            message: SignatureMessage;
            args: Record<PropertyKey, any>;
            signature: Signature;
        };
        [NotificationStatus.error]: {
            message: SignatureMessage;
            args: Record<PropertyKey, any>;
            error: Error;
        };
    };
}
export interface NotificationBody<Topic extends NotificationTopic = NotificationTopic, Status extends NotificationStatus = NotificationStatus> {
    id: string;
    topic: Topic;
    status: Status;
}
export type Notifications = {
    [Topic in NotificationTopic]: {
        [Status in NotificationStatus]: NotificationBody<Topic, Status> & (NotificationContext[Topic][Status] extends never ? unknown : {
            context: NotificationContext[Topic][Status];
        });
    };
};
export type TxNotification = Notifications[NotificationTopic.tx][NotificationStatus];
export type SignatureNotification = Notifications[NotificationTopic.signature][NotificationStatus];
export type Notification = Notifications[NotificationTopic][NotificationStatus];
export type NotificationsWithoutTopic = {
    [Topic in NotificationTopic]: {
        [Status in NotificationStatus]: Omit<NotificationBody<Topic, Status>, "topic"> & (NotificationContext[Topic][Status] extends never ? unknown : {
            context: NotificationContext[Topic][Status];
        });
    };
};
export interface NotificationConsumer<Topic extends NotificationTopic> {
    notifications$: Observable<Notifications[Topic][NotificationStatus]>;
    wait: (observerOrNext?: Partial<Observer<Notifications[Topic][NotificationStatus]>> | ((value: Notifications[Topic][NotificationStatus]) => void)) => Promise<Notifications[Topic][NotificationStatus.success | NotificationStatus.error]>;
}
/**
 * MUST receive a success or error notification at some point to ensure the result promise resolves.
 */
export declare class NotificationProducer<Topic extends NotificationTopic> {
    readonly topic: Topic;
    protected readonly _notifications$: ReplaySubject<Notifications[Topic][NotificationStatus]>;
    readonly notifications$: Observable<Notifications[Topic][NotificationStatus]>;
    protected readonly _result: Promise<Notifications[Topic][NotificationStatus]>;
    readonly consumer: NotificationConsumer<Topic>;
    /**
     * Creates a notification producer.
     * MUST receive a success or error notification at some point to ensure the result promise resolves.
     * @param topic The notification topic to populate each notification with.
     */
    constructor(topic: Topic);
    wait(observerOrNext?: Partial<Observer<Notifications[Topic][NotificationStatus]>> | ((value: Notifications[Topic][NotificationStatus]) => void)): Promise<Notifications[Topic][NotificationStatus.success | NotificationStatus.error]>;
    next(notification: NotificationsWithoutTopic[Topic][NotificationStatus]): void;
}
